\chapter{Conceptos previos}
\section{Entorno de desarrollo}
En esta sección se comentarán los diversos entornos en los que he trabajado en el Treball de Recerca, tanto desde un punto de vista de desarrrollo de programación como del desarrollo del documento escrito y la presentación oral.
\subsection{Programación}
Dependiendo del sistema operativo en el que se quiera trabajar es necesario tener una preparación concreta.

\subsubsection{Compilación}
Para poder compilar y ejecutar la librería y el motor gráfico son necesarias las herramientas básicas de compilación.
\begin{itemize}
\item{\textbf{make}: necesario para automatizar la compilación}
\item{\textbf{gcc}: programa utilizado como compilador y/o linker}
\item{\textbf{sdl2}: librería utilizada para desarrollo multiplataforma fácilmente, sirve como abstracción para la ventana y comunicación entre el Sistema Operativo y el programa}
\end{itemize}

Posteriormente se puede compilar yendo a la raíz de la carpeta y introduciendo algunos de los siguientes comandos:

\begin{itemize}
\item{\textbf{compilar} la librería gráfica propia y posteriormente compilar el programa}
\begin{lstlisting}[language=bash]
  $ make trgl
\end{lstlisting}
\item{\textbf{compilar} el programa utilizando OpenGL}
\begin{lstlisting}[language=bash]
  $ make opengl
\end{lstlisting}
\item{\textbf{ejecutar} el programa una vez la compilación ha terminado satisfactoriamente}
\begin{lstlisting}[language=bash]
  $ ./bin/program
\end{lstlisting}
\item{\textbf{limpiar} todos los archivos creados durante procesos anteriores de compilación}
\begin{lstlisting}[language=bash]
  $ make clean
\end{lstlisting}
\end{itemize}

\subsubsection{GNU Linux}
GNU Linux es el entorno en el que más cómodo trabajo por diversos motivos. Uno de ellos es lo simple que es encontrar, descargar, instalar y configurar nuevos programas en el sistema, gracias al gestor de paquetes que normalmente viene incluido en la mayoría de distribuciones.


Ubuntu es una de las distribuciones más comunes así que explicaré los requisitos previos para la compilación y ejecución del programa en Ubuntu.
\\ Todos los paquetes necesarios se pueden obtener con este comando.
\begin{lstlisting}[language=bash]
  $ sudo apt-get install git libsdl2-dev gcc
\end{lstlisting}
Se puede descargar el Treball de Recerca utilizando el siguiente comando en la carpeta deseada.
\begin{lstlisting}[language=bash]
  $ git clone https://github.com/gorostuck/treball-recerca
\end{lstlisting}

\subsubsection{macOS}
Para compilar macOS es un poco más laborioso debido a que no tiene un gestor de paquetes por defecto.
\\ Lo primero que hay que hacer es ir la página web de SDL y descargar las librerías de desarrollo.
\\ Una vez descargado el fichero .dmg, abrirlo y copiar ``SDL2.framework'' a \textit{/Library/Frameworks}.
\\ Después quizás es necesario volver a firmar el Framework, para hacer esto, hay que abrir una terminal en \textit{/Library/Frameworks/SDL2.framework/} y utilizar el siguiente comando:
\begin{lstlisting}[language=bash]
  $ codesign -f -s - SDL2
\end{lstlisting}
Si las \textit{Command Line Tools} no han sido instaladas previamente, la primera vez que intentemos utilizar el comando \textit{make} nos saltará una ventana preguntando si deseamos instalar las herramientas, para poder compilar el programa será necesario utilizar esas herramientas.

\subsubsection{Microsoft Windows}
Se recomienda fuertemente utilizar Code::Blocks para compilar en MS Windows, aunque es posible simular el compilador usado en los demás entornos (y de hecho es lo que ocurre en Code::Blocks).

\subsubsection{Code::Blocks}
Aunque no es mi entorno favorito, la verdad es que utilizar Code::Blocks es bastante conveniente y ha sido de utilidad para la depuración. Es tan sencillo como ir a la página y descargar Code::Blocks. Una vez descargado codeblocks, abrir el archivo .cbp dentro de la carpeta del proyecto y todo está listo para compilar y ejecutar. Otra ventaja que tiene es que es multiplataforma con lo que se puede usar en GNU Linux, macOS y en Windows. De hecho se recomienda usar Code::Blocks cuando se trabaje en Windows.

\subsubsection{Control de versión con git y GitHub}
Git es un programa utilizado para controlar un repositorio de código. En concreto, he utilizado el servicio web \textit{GitHub}. Aunque uno de sus principales objetivos es la colaboración entre distintos desarrolladores yo lo he empleado en las siguientes situaciones:
\begin{itemize}
\item{Ser capaz de tener todo el código archivado en un repositorio en internet para poder acceder remotamente y descargarlo.}
\item{Mantener un historial con todos los cambios que se han hecho.}
\item{Tener diversas ramas donde cambian elementos clave y desarrollarlas de forma paralela.}
\item{Visualizar rápidamente los cambios producidos entre diferentes versiones y ramas.}
\end{itemize}
\subsection{Documentación}
\subsubsection{Documento escrito}
Para redactar el documento escrito he utilizado \LaTeX, un lenguaje de programación orientado al procesamiento de texto. Esta herramienta me ha permitido organizar el Treball de Recerca de forma simple y efectiva, además de incluir trozos de código y comandos e incluso expresión matemática.
\subsection{GNU Emacs}
He decidido dar a GNU Emacs su propia subsección debido a que lo he usado constantemente a lo largo de la elaboración de este Treball de Recerca. Lo he usado tanto para programar la librería gráfica y el motor como para documentar todo el proceso. Además también me ha permitido hacer \textit{version control}, compilar e incluso ejecutar el motor gráfico desde el mismo programa. Decidí utilizarlo porque así me permitiría aumentar en gran medida mi rendimiento. Puesto a que es un programa extremadamente complejo, no entraré en gran detalle, pero las principales ventajas que ofrece es la gran modularidad y customizabilidad, por lo que lo he ido adaptando a mis necesidades según he ido avanzando en el proyecto.
\newpage
\section{Gestión de matrices}
La librería hace uso de las siguientes matrices:
\begin{itemize}
\item{\textbf{GL\_MODELVIEW}: Se utiliza para hacer transformaciones en los objetos. Más en el capítulo 5.}
\item{\textbf{GL\_PROJECTION}: Se utiliza para crear el volumen de visión, más en el capítulo 6.}
\end{itemize}
\subsection{Selección de la matriz}
Para seleccionar la matriz en la que se quiere trabajar se usa la función
\begin{lstlisting}[language=C]
  glMatrixMode(GLEnum matriz_deseada);
\end{lstlisting}
Y como único argumento pasamos el nombre de la matriz que queremos seleccionar, \textbf{GL\_MODELVIEW} o \textbf{GL\_PROJECTION}.
\subsection{Reseteo de la matriz}
Al llamar a la función
\begin{lstlisting}[language=C]
  glLoadIdentity();
\end{lstlisting}
la matriz que esté seleccionada actualmente verá sus valores cambiados por los siguientes.
\begin{figure}[ht]
  \centering
  \[
  \begin{bmatrix}
    1 && 0 && 0 && 0\\
    0 && 1 && 0 && 0\\
    0 && 0 && 1 && 0\\
    0 && 0 && 0 && 1
  \end{bmatrix}
  \]
\end{figure}
\subsection{Multiplicación de la matriz}
Multiplica la matriz selecionada por la matriz especificada.
\begin{lstlisting}[language=C]
  glMultMatrix(GLfloat *m);
\end{lstlisting}
m es un puntero hacia 16 floats consecutivos que representan una matriz 4x4.
\subsection{Carga de la matriz}
Se pueden sustituir los valores de la matriz seleccionada con la función
\begin{lstlisting}[language=C]
  glLoadMatrix(GLfloat *m)
\end{lstlisting}
m es un puntero hacia 16 floats consecutivos que representan una matriz 4x4.


